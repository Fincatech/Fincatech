let sudo={init:function(){$("body #listadoMensajes").length&&(sudo.Mensajes.CRUD.GetAll(),sudo.Mensajes.Init()),$("body .stats-sistema").length&&(sudo.Stats(),comunidadesCore.Render.tablaListadoComunidadesPendientes())},Mensajes:{Init:function(){sudo.Mensajes.Events()},Events:function(){$("body").on(core.helper.clickEventType,".btnReenviarMensaje",(function(e){var idMensaje=$(this).attr("data-id");apiFincatech.get(`mensaje/${idMensaje}/resend`).then(result=>{CoreUI.Modal.Success("El mensaje se ha reenviado correctamente","Reenviar mensaje")})})),$("body").on(core.helper.clickEventType,".btnVerMensajeEnviado",(function(evt){var idMensaje=$(this).attr("data-id");apiFincatech.get(`mensaje/${idMensaje}`).then(result=>{let resultado,body=JSON.parse(result).data.Mensaje[0].body;body=sudo.Mensajes.Helper.htmlEntities(body),body=body.replaceAll("https:/app.fincatech.es/","https://app.fincatech.es/"),console.log(body),CoreUI.Modal.CustomHTML(body,"Mensaje Enviado",null,"90%")})}))},CRUD:{GetAll:function(){$("#listadoMensajes").length&&(void 0!==window.tablelistadoMensajes&&(CoreUI.tableData.columns.listadoMensajes=[]),CoreUI.tableData.init(),CoreUI.tableData.addColumn("listadoMensajes","subject","Asunto",null,"text-left"),CoreUI.tableData.addColumn("listadoMensajes","email","EMAIL",null,"text-left"),CoreUI.tableData.addColumn("listadoMensajes",(function(row,type,val,meta){var timeStamp,fechaCreacion;return`<span style="display:none;">${timeStamp=moment(row.created,"YYYY-MM-DD hh:mm").unix()}</span>${fechaCreacion=moment(row.created).locale("es").format("L")}`}),"Fecha env√≠o",null,"text-center"),CoreUI.tableData.addColumn("listadoMensajes",(function(row,type,val,meta){var html;return`<ul class="nav justify-content-center accionesTabla">\n                                            <li class="nav-item mr-2">\n                                                <a href="javascript:void(0);" class="btnVerMensajeEnviado d-inline-block btn btn-success" data-id="${row.id}"><i data-feather="eye" class="text-white img-fluid"></i> Ver mensaje</a>\n                                            </li>                            \n                                            <li class="nav-item">\n                                                <a href="javascript:void(0);" class="btnReenviarMensaje d-inline-block btn btn-primary" data-id="${row.id}"><i data-feather="send" class="text-white img-fluid"></i> Reenviar mensaje</a>\n                                            </li>\n                                        </ul>`}),"&nbsp;",null,"text-center"),$("#listadoMensajes").addClass("no-clicable"),CoreUI.tableData.render("listadoMensajes","Mensaje","mensaje/list",null,!0,!0,null,null,!1,null,!0))}},Helper:{htmlEntities:function(rawStr){var textArea=document.createElement("textarea");return textArea.innerHTML=rawStr,textArea.value}}},Stats:function(){apiFincatech.get("stats/list").then(result=>{let data=JSON.parse(result);$(".stat-empresas").text(data.data.empresas),$(".stat-comunidades").text(data.data.comunidades),$(".stat-administradores").text(data.data.administradores),$(".stat-emails").text(data.data.emailscertificados),$(".stat-emails-enviados").text(data.data.emailsenviados)})}};$(()=>{sudo.init()});