let empresaCore={Empresa:Object(),empresa:Object(),init:async function(){this.events(),$("#listadoEmpresa").length&&empresaCore.renderTabla(),empresaCore.renderTablaEmpleados(core.modelId),$(".titulo-modulo").length&&"Empresa"==core.model&&CoreUI.setTitulo("razonsocial")},events:async function(){$("body").on(core.helper.clickEventType,".btnEliminarEmpresa",evt=>{evt.stopImmediatePropagation(),empresaCore.eliminar($(evt.currentTarget).attr("data-id"),$(evt.currentTarget).attr("data-nombre"))}),$("body").on(core.helper.clickEventType,".bntCrearNuevaEmpresaCAE",(function(evt){empresaCore.mostrarModalNuevaEmpresaCAE()}))},mostrarModalNuevaEmpresaCAE:async function(){apiFincatech.getView("empresa","form").then(resultHTML=>{Swal.fire({text:"",html:resultHTML,grow:"false",width:"120rem",showCancelButton:!0,showConfirmButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:'<i class="bi bi-save mr-2"></i> Guardar',cancelButtonText:'<i class="bi bi-x-circle mr-2"></i> Cancelar',reverseButtons:!0,buttonsStyling:!1,customClass:{actions:"text-center p-3 shadow-inset rounded-pill border-light border-2 bg-white",confirmButton:"btn btnSaveData btn-success shadow d-block pb-2 pt-2 confirmButtonModal",cancelButton:" btn btn-danger btnCancelSave shadow d-block pb-2 pt-2 mr-3 cancelButtonModal",popup:"bg-transparent"},didOpen:function(e){core.Forms.getSelectData("Empresatipo","Empresatipo.nombre","Empresatipo.id","","","tipoEmpresaComunidad",!0).then(()=>{$("body .formEmpresaComunidad #tipoEmpresaComunidad").select2({dropdownParent:$(".swal2-container"),theme:"bootstrap4"})}),core.Forms.getSelectData("Provincia","Provincia.Nombre","Provincia.Id","","","provinciaEmpresaComunidad",!0).then(()=>{$("body .formEmpresaComunidad #provinciaEmpresaComunidad").select2({dropdownParent:$(".swal2-container"),theme:"bootstrap4"})}),$(".swal2-container .btnSaveData").removeClass("btnSaveData")},preConfirm:function(e){return!!core.Forms.Validate("formEmpresaComunidad")||(Swal.showValidationMessage("Debe completar todos los campos marcados como obligatorios"),!1)}}).then(result=>{result.isConfirmed&&(core.Forms.mapFormDataToSave("formEmpresaComunidad"),core.Modelo.Insert("empresa",core.Forms.data,!1).then(()=>{window.tablelistadoEmpresaComunidad.ajax.reload()}).catch((function(e){return!1})))})})},eliminar:function(id,nombre){core.Modelo.Delete("empresa",id,nombre,"listadoEmpresa"),Swal.fire({title:`¿Desea eliminar la empresa:<br>${nombre}?`,text:"Se va a eliminar la empresa y toda la información asociada",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Eliminar",cancelButtonText:"Cancelar"}).then(result=>{result.isConfirmed&&apiFincatech.delete("empresa",id).then(result=>{Swal.fire("Empresas eliminada correctamente","","success"),$("#listadoEmpresa").DataTable().ajax.reload()})})},renderTabla:async function(){if($("#listadoEmpresa").length){CoreUI.tableData.init(),CoreUI.tableData.addColumnRow("listadoEmpresa","documentacioncae"),CoreUI.tableData.addColumn("listadoEmpresa","razonsocial","Nombre",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpresa","cif","CIF",null,"text-justify"),CoreUI.tableData.addColumn("listadoEmpresa","email","EMAIL",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpresa","telefono","TELEFONO",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpresa","personacontacto","Persona de contacto",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpresa","localidad","Localidad",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpresa","empresatipo[0].nombre","Tipo",null,"text-left");var html='<ul class="nav justify-content-center accionesTabla">';html+=`<li class="nav-item"><a href="${baseURL}empresa/data:id$" class="btnEditarEmpresa d-inline-block" data-id="data:id$" data-nombre="data:razonsocial$"><i data-feather="edit" class="text-success img-fluid"></i></a></li>`,html+='<li class="nav-item"><a href="javascript:void(0);" class="btnEliminarEmpresa d-inline-block" data-id="data:id$" data-nombre="data:razonsocial$"><i data-feather="trash-2" class="text-danger img-fluid"></i></li></ul>',CoreUI.tableData.addColumn("listadoEmpresa",null,"",html),$("#listadoEmpresa").addClass("no-clicable"),CoreUI.tableData.render("listadoEmpresa","Empresa","empresa/list")}},renderTablaSimple:async function(){if($("#listadoSimpleEmpresas").length){void 0!==window.tablelistadoSimpleEmpresas&&(CoreUI.tableData.columns.listadoSimpleEmpresas=[]),CoreUI.tableData.init(),CoreUI.tableData.addColumn("listadoSimpleEmpresas","razonsocial","Nombre",null,"text-left"),CoreUI.tableData.addColumn("listadoSimpleEmpresas","cif","CIF",null,"text-justify"),CoreUI.tableData.addColumn("listadoSimpleEmpresas","email","EMAIL",null,"text-left"),CoreUI.tableData.addColumn("listadoSimpleEmpresas","empresatipo[0].nombre","Tipo",null,"text-left");var html='<ul class="nav justify-content-center accionesTabla">';html+='<li class="nav-item">\n                                <a href="javascript:void(0);" class="btnConfirmarEmpresaCAE d-inline-block btn btn-sm btn-success" data-id="data:id$" data-nombre="data:razonsocial$">ASIGNAR</a>\n                            </li>\n                            </ul>',CoreUI.tableData.addColumn("listadoSimpleEmpresas",null,"",html),$("#listadoSimpleEmpresas").addClass("no-clicable"),CoreUI.tableData.render("listadoSimpleEmpresas","Empresa","empresa/list")}},renderTablaEmpleados:async function(idempresa){if($("#listadoEmpleadosEmpresa").length){CoreUI.tableData.init(),CoreUI.tableData.addColumn("listadoEmpleadosEmpresa","nombre","Nombre",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpleadosEmpresa","numerodocumento","DNI/NIE",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpleadosEmpresa","razonsocial","Empresa",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpleadosEmpresa","puesto","Puesto",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpleadosEmpresa","email","EMAIL",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpleadosEmpresa","telefono","TELEFONO",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpleadosEmpresa","fechaalta","Fecha alta",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpleadosEmpresa","fechabaja","Fecha baja",null,"text-left");var html="data:estado$";CoreUI.tableData.addColumn("listadoEmpleadosEmpresa",null,"Estado",html),CoreUI.tableData.render("listadoEmpleadosEmpresa","Empleados",`empresa/${idempresa}/empleados`,!1,!1,!1)}},renderTablaEmpresasComunidad:async function(idcomunidad){if(""!=idcomunidad&&void 0!==idcomunidad&&null!=idcomunidad&&$("#listadoEmpresaComunidad").length){CoreUI.tableData.init(),CoreUI.tableData.addColumnRow("listadoEmpresaComunidad","documentacioncae"),CoreUI.tableData.addColumn("listadoEmpresaComunidad","razonsocial","Nombre",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpresaComunidad","cif","CIF",null,"text-justify"),CoreUI.tableData.addColumn("listadoEmpresaComunidad","email","EMAIL",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpresaComunidad","telefono","TELEFONO",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpresaComunidad","personacontacto","Persona de contacto",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpresaComunidad","localidad","Localidad",null,"text-left"),CoreUI.tableData.addColumn("listadoEmpresaComunidad","tipoempresa","Tipo",null,"text-left");var html='<ul class="nav justify-content-center accionesTabla">';html+='<li class="nav-item"><a href="javascript:void(0);" class="btnEliminarEmpresaComunidad d-inline-block" data-id="data:id$" data-nombre="data:razonsocial$"><i data-feather="trash-2" class="text-danger img-fluid"></i></li></ul>',CoreUI.tableData.addColumn("listadoEmpresaComunidad",null,"",html),$("#listadoEmpresaComunidad").addClass("no-clicable"),CoreUI.tableData.render("listadoEmpresaComunidad","empresascomunidad",`comunidad/${idcomunidad}/empresas`,null,!1,!1)}}};$(()=>{empresaCore.init()});