let comunidadesCore={comunidades:Object(),comunidad:Object(),init:async function(){this.events(),"list"==core.actionModel&&"comunidad"==core.model.toLowerCase()&&(await comunidadesCore.listadoDashboard(),await comunidadesCore.renderMenuLateral())},events:function(){$("body").on(core.helper.clickEventType,".btnVerComunidad",evt=>{evt.stopImmediatePropagation(),comunidadesCore.verModalComunidad($(evt.currentTarget).attr("data-id"),$(evt.currentTarget).attr("data-nombre"))}),$("body").on(core.helper.clickEventType,".btnEliminarComunidad",evt=>{evt.stopImmediatePropagation(),comunidadesCore.eliminar($(evt.currentTarget).attr("data-id"),$(evt.currentTarget).attr("data-nombre"))})},eliminar:function(id,nombre){core.Modelo.Delete("comunidad",id,nombre,"listadoComunidades")},verModalComunidad:async function(idComunidad){var infoComunidad;comunidadesCore.getComunidad(idComunidad).then(result=>{infoComunidad=result,apiFincatech.getView("modals","comunidades/modal_info").then(resultHTML=>{result=CoreUI.Utils.parse(resultHTML,comunidadesCore.comunidad),console.log(result),CoreUI.Modal.GetHTML("modalInfoComunidad",result,comunidadesCore.comunidad.nombre)})})},renderMenuLateral:async function(){$(".navComunidades").append('<li class="sidebar-header">Comunidades</li>'),comunidadesCore.comunidades.forEach((function(valor,indice,array){var html=`<li class="sidebar-item">\n                            <a class="sidebar-link" href="/fincatech/comunidad/${valor.id}">\n                                <div class="row">\n                                    <div class="col-2">\n                                        <img src="/fincatech/public/assets/img/icon_edificio.png" class="img-responsive feather">\n                                    </div>\n                                    <div class="col-10 pr-0">\n                                        <span class="align-middle">${valor.codigo} - ${valor.nombre}</span>\n                                    </div>\n                                </div>\n                            </a>\n                        </li>`;$(".navComunidades").append(html)})),feather.replace()},renderTabla:async function(){if($("#listadoComunidad").length){CoreUI.tableData.init(),CoreUI.tableData.addColumn("codigo","COD"),CoreUI.tableData.addColumn("nombre","NOMBRE");var html='<a href="mailto:data:emailcontacto$" class="pl-1 pr-1">data:emailcontacto$</a>';CoreUI.tableData.addColumn(null,"EMAIL",html),CoreUI.tableData.addColumn("telefono","TELEFONO"),CoreUI.tableData.addColumn("nombre","doc pend. de subir"),CoreUI.tableData.addColumn("nombre","doc pend. de verificar");var html="data:created$";CoreUI.tableData.addColumn(null,"Fecha alta",html);var html="data:estado$";CoreUI.tableData.addColumn(null,"Estado",html);var html='<ul class="nav justify-content-center accionesTabla">';html+='<li class="nav-item"><a href="javascript:void(0);" class="btnVerComunidad d-inline-block" data-id="data:id$" data-nombre="data:nombre$"><i data-feather="eye" class="text-info img-fluid"></i></a></li>',html+=`<li class="nav-item"><a href="${baseURL}comunidad/data:id$" class="btnEditarComunidad d-inline-block" data-id="data:id$" data-nombre="data:nombre$"><i data-feather="edit" class="text-success img-fluid"></i></a></li>`,html+='<li class="nav-item"><a href="javascript:void(0);" class="btnEliminarComunidad d-inline-block" data-id="data:id$" data-nombre="data:nombre$"><i data-feather="trash-2" class="text-danger img-fluid"></i></li></ul>',CoreUI.tableData.addColumn(null,"",html),CoreUI.tableData.render("listadoComunidad","Comunidad","comunidad/list")}},listadoDashboard:async function(){await comunidadesCore.getAll().then(async data=>{$(".statscomunidades .total").html(comunidadesCore.comunidades.total),this.renderTabla()})},getComunidad:async function(comunidadId){await apiFincatech.get("comunidad/"+comunidadId).then(data=>(result=JSON.parse(data),responseStatus=result.status,responseData=result.data,comunidadesCore.comunidad=responseData.Comunidad[0],console.log(comunidadesCore.comunidad),comunidadesCore.comunidad))},getAll:async function(){await apiFincatech.get("comunidad/list").then(async data=>{result=JSON.parse(data),responseStatus=result.status,responseData=result.data,comunidadesCore.comunidades=responseData.Comunidad,comunidadesCore.comunidades.total=comunidadesCore.comunidades.length})}};$(()=>{comunidadesCore.init()});