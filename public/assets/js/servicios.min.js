let serviciosCore={servicios:Object(),servicio:Object(),caeContratado:!1,rgpdContratado:!1,init:async function(){await serviciosCore.renderServicios()},events:function(){},eliminar:function(id,nombre){},mapServiciosContratados:function(){core.Forms.data.comunidadservicioscontratados=[],$("body .dataServicioContratado").each((function(){var servicioContratado=0,servicioID=$(this).attr("data-idservicio"),servicioComunidadId=$(this).attr("data-idserviciocomunidad"),servicioPrecio=0,servicioPrecioComunidad=0;servicioContratado=$(this).find(".servicioContratado").is(":checked")?1:0,servicioPrecio=$(this).find(".servicioPrecio").val(),servicioPrecioComunidad=$(this).find(".servicioPrecioComunidad").val(),infoServicio=Object(),infoServicio.idserviciocomunidad=servicioComunidadId,infoServicio.idcomunidad=core.modelId,infoServicio.idservicio=servicioID,infoServicio.precio=servicioPrecio,infoServicio.preciocomunidad=servicioPrecioComunidad,infoServicio.contratado=servicioContratado,core.Forms.data.comunidadservicioscontratados.push(infoServicio)}))},addServiceToTable:function(servicioData,idServicioComunidad,fullInfo=!1){var checked=1==servicioData.contratado?' checked="checked" ':"";if(fullInfo){var html=`\n            <tr class="dataServicioContratado" data-idservicio="${servicioData.id}" data-idserviciocomunidad="${idServicioComunidad}">\n                <td class="mb-0 pb-0">\n                    <div class="form-check">\n                    <input type="hidden" class="data" hs-entity-related="comunidadservicioscontratados" hs-entity="Comunidad" hs-field="idservicio" value="${servicioData.id}">\n                        <input class="form-check-input servicioContratado" type="checkbox" ${checked} value="${servicioData.id}" data-id="${servicioData.id}" id="id-${servicioData.id}">\n                        <label class="form-check-label" for="id-${servicioData.id}">${servicioData.nombre}</label>\n                    </div>\n                </td>\n                <td class="mb-0 pb-0">\n                    <input type="number" class="form-control text-center data servicioPrecio" maxlength="6" hs-entity-related="comunidadservicioscontratados" hs-entity="Comunidad" hs-field="precio" value="${servicioData.precio}">\n                </td>\n                <td class="mb-0 pb-0">\n                    <input type="number" class="form-control text-center data servicioPrecioComunidad" maxlength="6" hs-entity-related="comunidadservicioscontratados" hs-entity="Comunidad" hs-field="preciocomunidad" value="${servicioData.preciocomunidad}">\n                </td>\n                <td class="mb-0 pb-0 text-right">\n                    <label class="retorno">${servicioData.retorno}â‚¬</label>\n                </td>\n            </tr>\n        `;$("body .form-servicioscontratados table tbody").append(html)}else{var iconoEstadoServicio=0==servicioData.contratado||void 0===servicioData.contratado?'<i class="bi bi-x-circle text-danger" style="font-size:21px;"></i>':'<i class="bi bi-check-circle text-success" style="font-size:21px;"></i>',html=`\n            <tr>\n                <td class="mb-0 pb-0">\n                        <label class="form-check-label">${servicioData.nombre}</label>\n                </td>\n                <td class="mb-0 pb-0 text-center">${iconoEstadoServicio}</td>\n            </tr>\n        `;$("body .form-servicioscontratados-info table tbody").append(html)}},renderServicios:async function(){var rol,endpointServicios="";switch($("body").attr("hs-role")){case"SUDO":if($(".form-servicioscontratados").length){switch(core.actionModel){case"add":endpointServicios="servicios/list",nombreEntidad="Tiposservicios",_isAdding=!0;break;case"get":endpointServicios=`comunidad/${core.modelId}/servicioscontratados`,nombreEntidad="comunidadservicioscontratados",_isAdding=!1}await apiFincatech.get(endpointServicios).then(data=>{for(result=JSON.parse(data),responseStatus=result.status,_isAdding?responseData=result.data:responseData=result.data.Comunidad[0],$("body .form-servicioscontratados table tbody").html(""),x=0;x<responseData[nombreEntidad].length;x++){console.log(responseData[nombreEntidad][x]);var idServicioComunidad="";void 0!==responseData[nombreEntidad][x].idserviciocomunidad&&(idServicioComunidad=responseData[nombreEntidad][x].idserviciocomunidad),serviciosCore.addServiceToTable(responseData[nombreEntidad][x],idServicioComunidad,!0)}})}break;default:if(void 0===core.modelId||""===core.modelId)return;endpointServicios=`comunidad/${core.modelId}/servicioscontratados`,nombreEntidad="comunidadservicioscontratados",await apiFincatech.get(endpointServicios).then(async data=>{if(result=JSON.parse(data),responseStatus=result.status,responseData=result.data.Comunidad[0],caeContratado=!1,rgpdContratado=!1,"ADMINFINCAS"==core.Security.getRole()&&(void 0!==responseData.comunidadservicioscontratados[0].contratado&&(caeContratado="0"!=responseData.comunidadservicioscontratados[0].contratado),void 0!==responseData.comunidadservicioscontratados[4].contratado&&(rgpdContratado="0"!=responseData.comunidadservicioscontratados[4].contratado)),"CONTRATISTA"==core.Security.getRole()||"TECNICOCAE"==core.Security.getRole())return $(".enlaceRGPD").remove(),$(".btnAsociarEmpresaCAE").remove(),$(".empresasComunidadHeader").remove(),$(".wrapperEmpresasComunidad").remove(),void $(".wrapperEmpleadosEmpresaComunidad").remove();for($(".enlaceCae").removeClass("text-success"),$(".enlaceCae").removeClass("text-danger"),!1===caeContratado?($(".enlaceCae").attr("href","#"),$(".enlaceCae").removeClass("enlaceCae").addClass("enlaceKOCae"),$(".enlaceKOCae").addClass("text-danger")):$(".enlaceCae").addClass("text-success"),$(".enlaceRGPD").removeClass("text-success"),$(".enlaceRGPD").removeClass("text-danger"),!1===rgpdContratado?($(".enlaceRGPD").attr("href","#"),$(".enlaceRGPD").removeClass("enlaceRGPD").addClass("enlaceKORGPD"),$(".enlaceKORGPD").addClass("text-danger")):$(".enlaceRGPD").addClass("text-success"),$("body .form-servicioscontratados-info table tbody").html(""),x=0;x<responseData[nombreEntidad].length;x++){var idServicioComunidad="";serviciosCore.addServiceToTable(responseData[nombreEntidad][x],null,!1)}})}},getSpa:async function(id){await apiFincatech.get("spa/"+id).then(data=>(result=JSON.parse(data),responseStatus=result.status,responseData=result.data,serviciosCore.spa=responseData.Spa[0],serviciosCore.spa))},getAll:async function(){await apiFincatech.get("servicios/list").then(async data=>{result=JSON.parse(data),responseStatus=result.status,responseData=result.data,serviciosCore.servicios=responseData.Tiposservicios,serviciosCore.servicios.total=serviciosCore.Tiposservicios.length})}};$(()=>{serviciosCore.init()});