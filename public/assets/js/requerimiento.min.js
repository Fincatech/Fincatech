let requerimientoCore={NotasInformativas:Object(),notainformativa:Object(),init:async function(){this.events(),$("#listadoRequerimiento").length?await requerimientoCore.renderTabla():(core.Files.init(),core.Files.Fichero.entidadId=core.modelId)},events:function(){$("body").on(core.helper.clickEventType,".btnEliminarRequerimiento",evt=>{evt.stopImmediatePropagation(),requerimientoCore.Model.Delete($(evt.currentTarget).attr("data-id"),$(evt.currentTarget).attr("data-nombre"))})},Model:{Delete:function(id,nombre){core.Modelo.Delete("requerimiento",id,nombre,"listadoRequerimiento","¿Desea eliminar el requerimiento seleccionado?")}},renderTabla:async function(){if($("#listadoRequerimiento").length){CoreUI.tableData.init();var html="data:created$";CoreUI.tableData.addColumn("listadoRequerimiento",null,"Fecha",html,"text-center","80px"),CoreUI.tableData.addColumn("listadoRequerimiento","nombre","NOMBRE",null,"text-justify"),CoreUI.tableData.addColumn("listadoRequerimiento","requerimientotipo[0].nombre","TIPO",null,"text-left"),CoreUI.tableData.addColumn("listadoRequerimiento",(function(row,type,val,meta){var sujetoRevision;return`<p class="text-center m-0">${"0"==row.sujetorevision||"null"==row.sujetorevision?"No":"Sí"}</p>`}),"Sujeto revisión",null,"text-center"),CoreUI.tableData.addColumn("listadoRequerimiento",(function(row,type,val,meta){var descargaPrevia;return`<p class="text-center m-0">${"0"==row.requieredescarga||"null"==row.requieredescarga?"No":"Sí"}</p>`}),"Requiere descarga previa",null,"text-center"),CoreUI.tableData.addColumn("listadoRequerimiento",(function(row,type,val,meta){var caduca;return`<p class="text-center m-0">${"0"==row.caduca||"null"==row.caduca?"No":"Sí"}</p>`}),"Caduca",null,"text-center");var html='<a href="'+config.baseURL+'public/storage/data:ficheroscomunes.nombrestorage$" target="_blank"><i class="bi bi-cloud-arrow-down" style="font-size:24px;"></i></a>';CoreUI.tableData.addColumn("listadoRequerimiento",null,"Fichero",html,"text-center","120px");var html="data:activado$";CoreUI.tableData.addColumn("listadoRequerimiento",null,"Activo",html,"text-center","100px"),CoreUI.tableData.addColumn("listadoRequerimiento",(function(row,type,val,meta){var html;return`\n                    <ul class="nav justify-content-center">\n                        <li class="nav-item">\n                            <a href="${config.baseURL}requerimiento/${row.id}" class="d-inline-block">\n                                <i data-feather="edit-2" class="text-success img-fluid text-success mr-2" style="width:26px;height:26px;"></i>\n                            </a>\n                        </li>\n                        <li class="nav-item">\n                            <a href="javascript:void(0);" class="btnEliminarRequerimiento d-inline-block" data-id="${row.id}" data-nombre="${row.nombre}"><i data-feather="trash-2" class="text-danger img-fluid" style="width:26px;height:26px;"></i></a>\n                        </li>\n                    </ul>`}),"&nbsp;",null,"text-center","40px"),$("#listadoRequerimiento").addClass("no-clicable"),await CoreUI.tableData.render("listadoRequerimiento","Requerimiento","requerimiento/list")}},renderTablaDocumentacionContratosCesion:async function(){if($("#listadoDocumentacionContratosCesion").length){CoreUI.tableData.init(),CoreUI.tableData.columns=[];var html=`\n                        <a href="${config.baseURL}public/storage/data:ficheroscomunes.nombrestorage$" target="_blank">\n                            <p class="m-0 d-inline-flex">\n                                <i class="bi bi-cloud-arrow-down pr-2" style="font-size:26px;"></i> \n                                <span class="align-self-center">data:nombre$</span>\n                            </p>\n                        </a>`;CoreUI.tableData.addColumn("listadoDocumentacionContratosCesion",null,"Fichero",html,"text-left","120px"),$("#listadoDocumentacionContratosCesion").addClass("no-clicable"),await CoreUI.tableData.render("listadoDocumentacionContratosCesion","Requerimiento","rgpd/requerimiento/3/list",!1,!1,!1)}},renderTablaDocumentacionCamarasSeguridad:async function(){if($("#listadoDocumentacionCamarasSeguridad").length){CoreUI.tableData.init();var html='<a href="'+config.baseURL+'public/storage/data:ficheroscomunes.nombrestorage$" target="_blank"><i class="bi bi-cloud-arrow-down mr-2" style="font-size:24px;"></i>data:nombre$</a>';CoreUI.tableData.addColumn("listadoDocumentacionCamarasSeguridad",null,"Fichero",html,"text-left","120px"),$("#listadoDocumentacionCamarasSeguridad").addClass("no-clicable"),await CoreUI.tableData.render("listadoDocumentacionCamarasSeguridad","Requerimiento","rgpd/requerimiento/2/list",!1,!1,!1)}},renderTablaContratosCesion:async function(idComunidad){if($("#listadoContratosCesion").length){CoreUI.tableData.init(),CoreUI.tableData.columns=[],CoreUI.tableData.addColumn("listadoContratosCesion","titulo","Título",null,"text-left"),CoreUI.tableData.addColumn("listadoContratosCesion","descripcion","Comentarios",null,"text-justify"),CoreUI.tableData.addColumn("listadoContratosCesion","ficheroscomunes[0]","DOCUMENTO",null,"text-center",null,(function(data,type,row,meta){var descarga="",salida;return row.ficheroscomunes.length>0&&(descarga=`<a href="${baseURL}public/storage/${row.ficheroscomunes[0].nombrestorage}" class="mr-2" data-toggle="tooltip" data-placement="bottom" title="Ver documento" data-original-title="Ver documento" target="_blank">\n                                        <i class="bi bi-cloud-arrow-down text-success" style="font-size: 30px;"></i>\n                                    </a>`),`${descarga}\n                                  <a href="javascript:void(0);" class="btnAdjuntarDocumentoRGPD" data-tipo="contratoscesion" data-idrequerimiento="${row.id}">\n                                    <i class="bi bi-cloud-arrow-up text-danger" style="font-size: 30px;"></i>\n                                  </a>\n                                  `}));var html="data:created$";CoreUI.tableData.addColumn("listadoContratosCesion",null,"Fecha de subida",html);var html='<ul class="nav justify-content-center accionesTabla">';html+='<li class="nav-item"><a href="javascript:void(0);" class="btnEliminarDocumentoRGPD d-inline-block" data-id="data:id$" data-tipo="contratoscesion" data-nombre="data:titulo$"><i data-feather="trash-2" class="text-danger img-fluid"></i></li></ul>',CoreUI.tableData.addColumn("listadoContratosCesion",null,"",html),$("#listadoCamarasSeguridad").addClass("no-clicable"),await CoreUI.tableData.render("listadoContratosCesion","ContratosCesion",`rgpd/documentacion/contratoscesion/${idComunidad}/list`,!1,!1,!1)}},renderTablaCamarasSeguridad:async function(idComunidad){if($("#listadoCamarasSeguridad").length){CoreUI.tableData.init(),CoreUI.tableData.columns=[],CoreUI.tableData.addColumn("listadoCamarasSeguridad","titulo","Título",null,"text-left"),CoreUI.tableData.addColumn("listadoCamarasSeguridad","descripcion","Comentarios",null,"text-justify"),CoreUI.tableData.addColumn("listadoCamarasSeguridad","ficheroscomunes[0]","SUBIR DOCUMENTO",null,"text-center",null,(function(data,type,row,meta){var salida="";return salida+=`<a href="javascript:void(0);" class="btnAdjuntarDocumentoRGPD" data-tipo="camarasseguridad" data-idrequerimiento="${row.id}">\n                                    <i class="bi bi-cloud-arrow-up text-danger" style="font-size: 30px;"></i>\n                                  </a>`})),CoreUI.tableData.addColumn("listadoCamarasSeguridad","ficheroscomunes[0]","DOCUMENTO SUBIDO",null,"text-center",null,(function(data,type,row,meta){var salida="";return row.ficheroscomunes.length>0?salida=`\n                        <a href="${baseURL}public/storage/${row.ficheroscomunes[0].nombrestorage}" class="mr-2" data-toggle="tooltip" data-placement="bottom" title="Ver documento" data-original-title="Ver documento" target="_blank">\n                            <i class="bi bi-file-earmark-arrow-down text-success" style="font-size: 26px;"></i>\n                        </a>`:salida+='<span class="badge bg-danger">Pendiente subir</span>',salida})),CoreUI.tableData.addColumn("listadoCamarasSeguridad","ficheroscomunes[0]","Fecha de subida",null,"text-center",null,(function(data,type,row,meta){var salida="";return row.updated?salida+=`<span>${moment(row.updated).locale("es").format("DD/MM/YYYY HH:mm")}</span>`:salida='\n                        <span class="m-0">-</span>',salida}));var html='<ul class="nav justify-content-center accionesTabla">';html+='<li class="nav-item"><a href="javascript:void(0);" class="btnEliminarDocumentoRGPD d-inline-block" data-id="data:id$" data-tipo="camarasseguridad" data-nombre="data:titulo$"><i data-feather="trash-2" class="text-danger img-fluid"></i></li></ul>',CoreUI.tableData.addColumn("listadoCamarasSeguridad",null,"",html),$("#listadoCamarasSeguridad").addClass("no-clicable"),CoreUI.tableData.render("listadoCamarasSeguridad","CamarasSeguridad",`rgpd/documentacion/camarasseguridad/${idComunidad}/list`,!1,!1,!1)}return!0},renderEtiquetaEstado:function(value){var clase,estado;switch(value.toLowerCase()){case"pv":estado="Pendiente de verificación",clase="info";break;case"ve":estado="Verificado",clase="success";break;case"re":estado="Rechazado",clase="danger";break;case"ca":estado="Caducado",clase="danger";break;case"ps":estado="Pendiente de subir",clase="warning";break;case"na":estado="No adjuntado",clase="danger";break;default:estado="Pendiente",clase="danger"}return`<span class="badge rounded-pill bg-${clase} pl-3 pr-3 pt-2 pb-2 d-block">${estado}</span>`}};$(()=>{requerimientoCore.init()});